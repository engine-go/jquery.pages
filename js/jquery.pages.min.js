(function($){$.fn.extend({pages:function(options){var _page=this,tpl="",LANG,_url=window.location.href,_pageSize=0,defaults={url:"",curPage:1,pageLimit:20,dataCount:0,labelCount:10,lang:{total:"共 ",records_desc:"条数据 本页 ",item:" 条，",page:" 页"},callback:function(){}};defaults=$.extend(defaults,options);_page.curPage=defaults.curPage;_page.dataCount=defaults.dataCount;_page.pageLimit=defaults.pageLimit;_page.nowCount=_page.pageLimit;LANG=defaults.lang;_page.url=_url;_pageSize=getPageSize();function getPageSize(){return Math.ceil(_page.dataCount/_page.pageLimit)}_page.checkPage=function(pno){if(pno&&pno<1){pno=1}else if(pno&&pno>_page.pageLimit){pnp=_page.pageLimit}return pno||1};function pageTips(){if(_page.dataCount<_page.pageLimit){_page.nowCount=_page.dataCount}else if(_pageSize==_page.curPage){_page.nowCount=_page.dataCount%_page.pageLimit}else if(_page.dataCount>_page.pageLimit){_page.nowCount=_page.pageLimit}tpl+='<span class="page-tip">'+LANG.total+"<b> "+_page.dataCount+" </b>"+LANG.records_desc+"<b>"+_page.nowCount+"</b>"+LANG.item+LANG.total+"<b>"+_pageSize+"</b>"+LANG.page+"</span>"}if(defaults.url){_page.url=defaults.url}function firstPage(){if(_page.curPage==1){tpl+='<a href="javascript:void(0);" style="cursor:not-allowed" class="page-firsted">&lt;&lt;</a>'}else{tpl+='<a href="javascript:void(0);" class="page-first">&lt;&lt;</a>';addListener("page-first",1)}}function prevPage(){if(_page.curPage>1){tpl+='<a href="javascript:void(0);" class="page-prev">&lt;</a>';addListener("page-prev",_page.curPage-1)}else{tpl+='<a href="javascript:void(0);" style="cursor:not-allowed" class="page-preved">&lt;</a>'}}function pageList(){var cp=_page.curPage;var lc=defaults.labelCount;var middle=Math.floor(lc/2);tpl+="<b>";for(var i=middle;i>=1;i--){var p=cp-i;if(p>=1){tpl+='<a href="javascript:void(0);" class="page-list'+p+'">'+p+"</a>";addListener("page-list"+p,p)}}if(cp>=1){tpl+='<span class="page-active">'+cp+"</span>"}for(var i=1;i<middle;i++){var p=cp+i;if(p<=_pageSize){tpl+='<a href="javascript:void(0);" class="page-list'+p+'">'+p+"</a>";addListener("page-list"+p,p)}}tpl+="</b>"}function nextPage(){if(_page.curPage<_pageSize){tpl+='<a href="javascript:void(0);" class="page-next">&gt;</a>';addListener("page-next",_page.curPage+1)}else{tpl+='<a href="javascript:void(0);" style="cursor:not-allowed" class="page-nexted">&gt;</a>'}}function lastPage(){if(_page.dataCount>0&&_page.curPage!=_pageSize){tpl+='<a href="javascript:void(0);" class="page-last">&gt;&gt;</a></div><div style="clear:both"></div>';addListener("page-last",_pageSize)}else{tpl+='<a href="javascript:void(0);" class="page-lasted" style="cursor:not-allowed">&gt;&gt;</a></div><div style="clear:both"></div>'}}function addListener(type,page){_page.off("click","a."+type);_page.on("click","a."+type,function(e){getData(page,type)})}function getData(page,type){if(defaults.type=="static"){defaults.callback(page,_page);_page.curPage=page;createPages();return false}$.get(doUrl(_page.url)+"&page="+page+"&pageLimit="+defaults.pageLimit,function(res){if(defaults.callback&&typeof defaults.callback=="function"){defaults.callback(res,_page);_page.curPage=page;createPages()}})}function doUrl(url){if(url.indexOf("?")==-1){url+="?"}var char=url.charAt(url.length-1);if(char=="&"||char=="?"){url+="_t="+Math.random()}else{url+="&_t="+Math.random()}return url}function createPages(){_pageSize=getPageSize();pageTips();firstPage();prevPage();pageList();nextPage();lastPage();tpl="<div>"+tpl+"</div>";_page.empty().html(tpl);tpl=""}createPages();_page.refresh=function(){_page.curPage=1;createPages()};return _page}})})(jQuery);Date.prototype.Format=function(fmt){var o={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};if(/(y+)/.test(fmt))fmt=fmt.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length));for(var k in o)if(new RegExp("("+k+")").test(fmt))fmt=fmt.replace(RegExp.$1,RegExp.$1.length==1?o[k]:("00"+o[k]).substr((""+o[k]).length));return fmt};
